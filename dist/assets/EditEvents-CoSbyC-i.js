import{f as je,c as Se,d as ye,r as t,b as Ve,j as e}from"./index-DKMTHIRv.js";import{I as s}from"./Input-BKGtnkGm.js";import{D as Ne}from"./Drawer-COasE5QF.js";import{c as ke,e as Ee}from"./fetch-DXQ-Dk4T.js";import{T as O}from"./TextArea-BAmllQoI.js";import"./TabFlag-BsW4hRx-.js";import"./url-BdNy_9Mu.js";const ze=()=>{const{token:i}=je(),d=Se(),P=ye(),{event:a}=P.state||{},[v]=t.useState(a.id),[u,R]=t.useState(a.title_es),[m,F]=t.useState(a.title_en),[p,G]=t.useState(a.description_es),[g,J]=t.useState(a.description_en),[j,C]=t.useState(a.price),[h,H]=t.useState(a.date.slice(0,10)),[w,$]=t.useState(a.time),[b,q]=t.useState(a.address),[S,B]=t.useState(a.lat),[y,K]=t.useState(a.long),[n,V]=t.useState(null),[f,M]=t.useState(a.img_path),[r,N]=t.useState(f?1:0),[Q,W]=t.useState(!1),[X,Y]=t.useState(!1),[Z,ee]=t.useState(!1),[te,ae]=t.useState(!1),[se,le]=t.useState(!1),[ie,ne]=t.useState(!1),[oe,re]=t.useState(!1),[ce,de]=t.useState(!1),[ue,fe]=t.useState(!1),[xe,me]=t.useState(!1),[pe,k]=t.useState(!1),[ge,E]=t.useState(!1),{showSnackbar:l}=Ve();t.useEffect(()=>{i||d("/admin/login")},[i,d]),t.useEffect(()=>{n&&(M(URL.createObjectURL(n)),console.log(f),console.log(n),r!==1&&N(2))},[n]);const he=async o=>{o.preventDefault();const c=u==="",x=m==="",D=p==="",I=g==="",L=!1,_=h==="",A=w==="",T=b==="",U=!1,z=!1;if(W(c),Y(x),ee(D),ae(I),le(L),ne(_),re(A),de(T),fe(U),me(z),!c&&!x&&!D&&!I&&!L&&!_&&!A&&!T&&!U&&!z){if(!i){l("Error de autenticación.","error"),d("dashboard/login");return}k(!0);const be=JSON.stringify({title_es:u,title_en:m,description_es:p,description_en:g,price:j,date:h,time:w,address:b,lat:S,long:y});try{await ke("events",v,be,i),l("Evento actualizado correctamente.","success")}catch(ve){l(`Ocurrió un error al guardar los datos. ${ve}`,"error")}finally{k(!1)}}},we=async o=>{if(o.preventDefault(),n){if(!i){l("Error de autenticación.","error"),d("dashboard/login");return}E(!0);const c=new FormData;c.append("img",n);try{await Ee("events",v,c,i),l("Imagen actualizada exitosamente.","success"),N(1),V(null)}catch(x){l("Ocurrió un error al actualizar la imagen.","error"),console.log(x)}finally{E(!1)}}else l("No se ha seleccionado ninguna imagen.","error")};return e.jsxs("div",{className:"h-screen flex flex-col lg:flex-row",children:[e.jsx(Ne,{page:3}),e.jsx("div",{className:"flex-1 flex-col space-y-4 overflow-y-auto h-full bg-background-darker dark:bg-background-deep p-16",children:e.jsxs("div",{className:"",children:[e.jsx("span",{className:"font-normal",children:"Editar evento"}),e.jsxs("div",{className:"w-full flex flex-row space-x-4 mt-4",children:[e.jsx("form",{onSubmit:we,className:"w-2/6 2xl:w-1/6 h-full bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-4",children:e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4",children:[e.jsx("span",{className:"font-normal",children:"Imagen"}),f?e.jsx("img",{src:f,alt:u,className:"w-full h-auto rounded-md p-1 border-solid border-2 border-border dark:border-border-dark object-cover"}):e.jsx("div",{}),e.jsx("input",{type:"file",accept:"image/*,video/*",onChange:o=>V(o.target.files?o.target.files[0]:null),className:"block w-full max-w-xs text-sm text-gray-500 dark:text-gray-300"}),e.jsx("div",{className:"w-full flex flex-col space-y-2 justify-center ",children:e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium",children:ge?r===0||r===2?"Agregando...":"Actualizando...":r===0||r===2?"Agregar":"Actualizar"})})]})}),e.jsxs("form",{onSubmit:he,className:"w-4/6 2xl:w-5/6 h-full bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-4",children:[e.jsx("span",{className:"font-normal",children:"Datos"}),e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(s,{type:"text",label:"Titulo",flag:"es",value:u,setValue:R,maxLength:256,status:Q,width:"w-full"}),e.jsx(s,{type:"text",label:"Titulo",flag:"en",value:m,setValue:F,maxLength:256,status:X,width:"w-full"})]}),e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(O,{label:"Descripción",flag:"es",value:p,setValue:G,maxLength:2048,status:Z,width:"w-full"}),e.jsx(O,{label:"Descripción",flag:"en",value:g,setValue:J,maxLength:2048,status:te,width:"w-full"})]}),e.jsxs("div",{className:"w-full flex flex-col 2xl:flex-row space-y-4 2xl:space-y-0 space-x-0 2xl:space-x-2",children:[e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(s,{type:"number",label:"Precio",value:j,setValue:C,status:se,width:"w-full 2xl:w-2/12"}),e.jsx(s,{type:"date",label:"Fecha",value:h,setValue:H,status:ie,width:"w-full 2xl:w-2/12"}),e.jsx(s,{type:"time",label:"Hora",value:w,setValue:$,maxLength:32,status:oe,width:"w-full 2xl:w-2/12"})]}),e.jsx(s,{type:"text",label:"Dirección",value:b,setValue:q,maxLength:256,status:ce,width:"w-full 2xl:w-1/2"})]}),e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(s,{type:"number",label:"Latitud",value:S,setValue:B,status:ue,width:"w-2/6 2xl:w-1/4"}),e.jsx(s,{type:"number",label:"Longitud",value:y,setValue:K,status:xe,width:"w-2/6 2xl:w-1/4"})]}),e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium mx-auto",children:pe?"Guardando...":"Guardar"})]})]})]})})]})};export{ze as default};
