import{c as A,d as O,f as L,r as a,e as C,j as e}from"./index-CsZ0w_GZ.js";import{I as R}from"./Input-Bqd8-Stj.js";import{D as V}from"./Drawer-CLs5twCO.js";import{c as G,d as J,e as M}from"./fetch-BYPxA0rK.js";import"./TabFlag-DqMcl6yo.js";import"./url-BdNy_9Mu.js";const H=()=>{const{token:r}=A(),n=O(),j=L(),{member:m}=j.state||{},[u]=a.useState(m.id),[c,w]=a.useState(m.name),[l,f]=a.useState(null),[d,b]=a.useState(m.img_path),[o,g]=a.useState(d?1:0),[k,N]=a.useState(!1),[S,p]=a.useState(!1),[v,h]=a.useState(!1),[I,y]=a.useState(!1),{showSnackbar:t}=C();a.useEffect(()=>{r||n("/admin/login")},[r,n]),a.useEffect(()=>{l&&(b(URL.createObjectURL(l)),console.log(d),console.log(l),o!==1&&g(2))},[l]);const D=async s=>{s.preventDefault();const i=c==="";if(N(i),!i){if(!r){t("Error de autenticación.","error"),n("dashboard/login");return}p(!0);const x=JSON.stringify({name:c});try{await G("chamber-members",u,x,r),t("Miembro actualizado correctamente.","success")}catch(z){t(`Ocurrió un error al guardar los datos. ${z}`,"error")}finally{p(!1)}}},E=async()=>{if(!r){t("Error de autenticación.","error"),n("dashboard/login");return}y(!0);try{await J("chamber-members",u,r),b(""),t("Imagen eliminada exitosamente.","success"),g(0),f(null)}catch(s){t("Ocurrió un error al eliminar la imagen .","error"),console.log(s)}finally{y(!1)}},U=async s=>{if(s.preventDefault(),l){if(!r){t("Error de autenticación.","error"),n("dashboard/login");return}h(!0);const i=new FormData;i.append("img",l);try{await M("chamber-members",u,i,r),t("Imagen actualizada exitosamente.","success"),g(1),f(null)}catch(x){t("Ocurrió un error al actualizar la imagen.","error"),console.log(x)}finally{h(!1)}}else t("No se ha seleccionado ninguna imagen.","error")};return e.jsxs("div",{className:"h-screen flex flex-col lg:flex-row",children:[e.jsx(V,{page:4}),e.jsx("div",{className:"flex-1 flex-col space-y-4 overflow-y-auto h-full bg-background-darker dark:bg-background-deep p-16",children:e.jsxs("div",{className:"",children:[e.jsx("span",{className:"font-normal",children:"Editar tarifa de afiliación"}),e.jsxs("div",{className:"w-full flex flex-row space-x-4 mt-8",children:[e.jsx("form",{onSubmit:U,className:"w-1/2 h-auto bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-8",children:e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4",children:[e.jsx("span",{children:"Imagen"}),d?e.jsx("img",{src:d,alt:c,className:"w-48 h-48 rounded-full mt-2 p-1 border-solid border-2 border-border dark:border-border-dark"}):e.jsx("div",{className:"w-48 h-48 rounded-full mt-2 p-1 border-solid border-2 border-border dark:border-border-dark",children:e.jsx("div",{className:"w-full h-full bg-option rounded-full"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>f(s.target.files?s.target.files[0]:null),className:"block w-full max-w-xs text-sm text-gray-500 dark:text-gray-300"}),e.jsxs("div",{className:"w-full flex flex-row space-x-2 pt-4 justify-center ",children:[e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium",children:v?o===0||o===2?"Agregando...":"Actualizando...":o===0||o===2?"Agregar":"Actualizar"}),o===1?e.jsx("button",{type:"button",className:"w-full h-9 bg-red-600 hover:bg-red-700 text-selected-dark px-2 py-1 rounded-lg text-sm font-medium",onClick:E,children:I?"Eliminando...":"Eliminar"}):e.jsx("div",{})]})]})}),e.jsxs("form",{onSubmit:D,className:"w-1/2 h-full bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-8",children:[e.jsx(R,{type:"text",label:"Nombre",value:c,setValue:w,maxLength:128,status:k,width:"w-full"}),e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium mx-auto",children:S?"Guardando...":"Guardar"})]})]})]})})]})};export{H as default};
