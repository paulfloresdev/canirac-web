import{c as Ve,d as Ne,f as ke,r as t,e as Ee,j as e}from"./index-CsZ0w_GZ.js";import{I as n}from"./Input-Bqd8-Stj.js";import{D as De}from"./Drawer-CLs5twCO.js";import{c as Ie,d as Le,e as _e}from"./fetch-BYPxA0rK.js";import{T as R}from"./TextArea-nbGiXuqS.js";import"./TabFlag-DqMcl6yo.js";import"./url-BdNy_9Mu.js";const Ce=()=>{const{token:l}=Ve(),c=Ne(),C=ke(),{event:a}=C.state||{},[x]=t.useState(a.id),[u,F]=t.useState(a.title_es),[g,G]=t.useState(a.title_en),[p,J]=t.useState(a.description_es),[h,H]=t.useState(a.description_en),[S,$]=t.useState(a.price),[b,q]=t.useState(a.date.slice(0,10)),[w,B]=t.useState(a.time),[v,K]=t.useState(a.address),[V,M]=t.useState(a.lat),[N,Q]=t.useState(a.long),[r,y]=t.useState(null),[f,k]=t.useState(a.img_path),[o,j]=t.useState(f?1:0),[W,X]=t.useState(!1),[Y,Z]=t.useState(!1),[ee,te]=t.useState(!1),[ae,se]=t.useState(!1),[le,ie]=t.useState(!1),[ne,re]=t.useState(!1),[oe,ce]=t.useState(!1),[de,ue]=t.useState(!1),[fe,me]=t.useState(!1),[xe,ge]=t.useState(!1),[pe,E]=t.useState(!1),[he,D]=t.useState(!1),[be,I]=t.useState(!1),{showSnackbar:s}=Ee();t.useEffect(()=>{l||c("/admin/login")},[l,c]),t.useEffect(()=>{r&&(k(URL.createObjectURL(r)),console.log(f),console.log(r),o!==1&&j(2))},[r]);const we=async i=>{i.preventDefault();const d=u==="",m=g==="",L=p==="",_=h==="",A=!1,T=b==="",U=w==="",z=v==="",O=!1,P=!1;if(X(d),Z(m),te(L),se(_),ie(A),re(T),ce(U),ue(z),me(O),ge(P),!d&&!m&&!L&&!_&&!A&&!T&&!U&&!z&&!O&&!P){if(!l){s("Error de autenticación.","error"),c("dashboard/login");return}E(!0);const je=JSON.stringify({title_es:u,title_en:g,description_es:p,description_en:h,price:S,date:b,time:w,address:v,lat:V,long:N});try{await Ie("events",x,je,l),s("Evento actualizado correctamente.","success")}catch(Se){s(`Ocurrió un error al guardar los datos. ${Se}`,"error")}finally{E(!1)}}},ve=async()=>{if(!l){s("Error de autenticación.","error"),c("dashboard/login");return}I(!0);try{await Le("events",x,l),k(""),s("Imagen eliminada exitosamente.","success"),j(0),y(null)}catch(i){s("Ocurrió un error al eliminar la imagen .","error"),console.log(i)}finally{I(!1)}},ye=async i=>{if(i.preventDefault(),r){if(!l){s("Error de autenticación.","error"),c("dashboard/login");return}D(!0);const d=new FormData;d.append("img",r);try{await _e("events",x,d,l),s("Imagen actualizada exitosamente.","success"),j(1),y(null)}catch(m){s("Ocurrió un error al actualizar la imagen.","error"),console.log(m)}finally{D(!1)}}else s("No se ha seleccionado ninguna imagen.","error")};return e.jsxs("div",{className:"h-screen flex flex-col lg:flex-row",children:[e.jsx(De,{page:3}),e.jsx("div",{className:"flex-1 flex-col space-y-4 overflow-y-auto h-full bg-background-darker dark:bg-background-deep p-16",children:e.jsxs("div",{className:"",children:[e.jsx("span",{className:"font-normal",children:"Editar tarifa de afiliación"}),e.jsxs("div",{className:"w-full flex flex-row space-x-4 mt-8",children:[e.jsx("form",{onSubmit:ye,className:"w-2/6 2xl:w-1/6 h-full bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-8",children:e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4",children:[e.jsx("span",{children:"Imagen"}),f?e.jsx("img",{src:f,alt:u,className:"w-4/6 2xl:w-full h-56 rounded-md mt-2 p-1 border-solid border-2 border-border dark:border-border-dark object-cover"}):e.jsx("div",{className:"w-24 h-32 rounded-sm mt-2 p-1 border-solid border-2 border-border dark:border-border-dark",children:e.jsx("div",{className:"w-full h-full bg-option rounded-sm"})}),e.jsx("input",{type:"file",accept:"image/*,video/*",onChange:i=>y(i.target.files?i.target.files[0]:null),className:"block w-full max-w-xs text-sm text-gray-500 dark:text-gray-300"}),e.jsxs("div",{className:"w-full flex flex-col space-y-2 pt-4 justify-center ",children:[e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium",children:he?o===0||o===2?"Agregando...":"Actualizando...":o===0||o===2?"Agregar":"Actualizar"}),o===1?e.jsx("button",{type:"button",className:"w-full h-9 bg-red-600 hover:bg-red-700 text-selected-dark px-2 py-1 rounded-lg text-sm font-medium",onClick:ve,children:be?"Eliminando...":"Eliminar"}):e.jsx("div",{})]})]})}),e.jsxs("form",{onSubmit:we,className:"w-4/6 2xl:w-5/6 h-full bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-8",children:[e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(n,{type:"text",label:"Titulo",flag:"es",value:u,setValue:F,maxLength:256,status:W,width:"w-full"}),e.jsx(n,{type:"text",label:"Titulo",flag:"en",value:g,setValue:G,maxLength:256,status:Y,width:"w-full"})]}),e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(R,{label:"Descripción",flag:"es",value:p,setValue:J,maxLength:2048,status:ee,width:"w-full"}),e.jsx(R,{label:"Descripción",flag:"en",value:h,setValue:H,maxLength:2048,status:ae,width:"w-full"})]}),e.jsxs("div",{className:"w-full flex flex-col 2xl:flex-row space-y-8 2xl:space-y-0 space-x-0 2xl:space-x-2",children:[e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(n,{type:"number",label:"Precio",value:S,setValue:$,status:le,width:"w-full 2xl:w-2/12"}),e.jsx(n,{type:"date",label:"Fecha",value:b,setValue:q,status:ne,width:"w-full 2xl:w-2/12"}),e.jsx(n,{type:"time",label:"Hora",value:w,setValue:B,maxLength:32,status:oe,width:"w-full 2xl:w-2/12"})]}),e.jsx(n,{type:"text",label:"Dirección",value:v,setValue:K,maxLength:256,status:de,width:"w-full 2xl:w-1/2"})]}),e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(n,{type:"number",label:"Latitud",value:V,setValue:M,status:fe,width:"w-2/6 2xl:w-1/4"}),e.jsx(n,{type:"number",label:"Longitud",value:N,setValue:Q,status:xe,width:"w-2/6 2xl:w-1/4"})]}),e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium mx-auto",children:pe?"Guardando...":"Guardar"})]})]})]})})]})};export{Ce as default};
