import{c as M,d as Q,f as W,r as t,e as X,j as e}from"./index-FFSDp5PZ.js";import{I as N}from"./Input-fkGOEq6T.js";import{D as Y}from"./Drawer-B5C_NWhF.js";import{c as Z,d as ee,e as te}from"./fetch-BYPxA0rK.js";import{T as E}from"./TextArea-C2uk5jZf.js";import"./TabFlag-uJRE_99S.js";import"./url-BdNy_9Mu.js";const ce=()=>{const{token:s}=M(),o=Q(),D=W(),{service:l}=D.state||{},[f]=t.useState(l.id),[d,I]=t.useState(l.title_es),[x,V]=t.useState(l.title_en),[g,_]=t.useState(l.description_es),[p,L]=t.useState(l.description_en),[i,h]=t.useState(null),[u,v]=t.useState(l.img_path),[n,b]=t.useState(u?1:0),[A,T]=t.useState(!1),[U,z]=t.useState(!1),[O,R]=t.useState(!1),[C,G]=t.useState(!1),[J,w]=t.useState(!1),[P,y]=t.useState(!1),[F,j]=t.useState(!1),{showSnackbar:a}=X();t.useEffect(()=>{s||o("/admin/login")},[s,o]),t.useEffect(()=>{i&&(v(URL.createObjectURL(i)),console.log(u),console.log(i),n!==1&&b(2))},[i]);const $=async r=>{r.preventDefault();const c=d==="",m=x==="",S=g==="",k=p==="";if(T(c),z(m),R(S),G(k),!c&&!m&&!S&&!k){if(!s){a("Error de autenticación.","error"),o("dashboard/login");return}w(!0);const H=JSON.stringify({title_es:d,title_en:x,description_es:g,description_en:p});try{await Z("services",f,H,s),a("Servicio actualizado correctamente.","success")}catch(K){a(`Ocurrió un error al guardar los datos. ${K}`,"error")}finally{w(!1)}}},q=async()=>{if(!s){a("Error de autenticación.","error"),o("dashboard/login");return}j(!0);try{await ee("services",f,s),v(""),a("Imagen eliminada exitosamente.","success"),b(0),h(null)}catch(r){a("Ocurrió un error al eliminar la imagen .","error"),console.log(r)}finally{j(!1)}},B=async r=>{if(r.preventDefault(),i){if(!s){a("Error de autenticación.","error"),o("dashboard/login");return}y(!0);const c=new FormData;c.append("img",i);try{await te("services",f,c,s),a("Imagen actualizada exitosamente.","success"),b(1),h(null)}catch(m){a("Ocurrió un error al actualizar la imagen.","error"),console.log(m)}finally{y(!1)}}else a("No se ha seleccionado ninguna imagen.","error")};return e.jsxs("div",{className:"h-screen flex flex-col lg:flex-row",children:[e.jsx(Y,{page:3}),e.jsx("div",{className:"flex-1 flex-col space-y-4 overflow-y-auto h-full bg-background-darker dark:bg-background-deep p-16",children:e.jsxs("div",{className:"",children:[e.jsx("span",{className:"font-normal",children:"Editar tarifa de afiliación"}),e.jsxs("div",{className:"w-full flex flex-row space-x-4 mt-8",children:[e.jsx("form",{onSubmit:B,className:"w-2/6 2xl:w-1/6 h-full bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-8",children:e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4",children:[e.jsx("span",{children:"Imagen"}),u?e.jsx("img",{src:u,alt:d,className:"w-4/6 2xl:w-full h-56 rounded-md mt-2 p-1 border-solid border-2 border-border dark:border-border-dark object-cover"}):e.jsx("div",{className:"w-24 h-32 rounded-sm mt-2 p-1 border-solid border-2 border-border dark:border-border-dark",children:e.jsx("div",{className:"w-full h-full bg-option rounded-sm"})}),e.jsx("input",{type:"file",accept:"image/*,video/*",onChange:r=>h(r.target.files?r.target.files[0]:null),className:"block w-full max-w-xs text-sm text-gray-500 dark:text-gray-300"}),e.jsxs("div",{className:"w-full flex flex-col space-y-2 pt-4 justify-center ",children:[e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium",children:P?n===0||n===2?"Agregando...":"Actualizando...":n===0||n===2?"Agregar":"Actualizar"}),n===1?e.jsx("button",{type:"button",className:"w-full h-9 bg-red-600 hover:bg-red-700 text-selected-dark px-2 py-1 rounded-lg text-sm font-medium",onClick:q,children:F?"Eliminando...":"Eliminar"}):e.jsx("div",{})]})]})}),e.jsxs("form",{onSubmit:$,className:"w-4/6 2xl:w-5/6 h-full bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-8",children:[e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(N,{type:"text",label:"Titulo",flag:"es",value:d,setValue:I,maxLength:256,status:A,width:"w-full"}),e.jsx(N,{type:"text",label:"Titulo",flag:"en",value:x,setValue:V,maxLength:256,status:U,width:"w-full"})]}),e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(E,{label:"Descripción",flag:"es",value:g,setValue:_,maxLength:2048,status:O,width:"w-full"}),e.jsx(E,{label:"Descripción",flag:"en",value:p,setValue:L,maxLength:2048,status:C,width:"w-full"})]}),e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium mx-auto",children:J?"Guardando...":"Guardar"})]})]})]})})]})};export{ce as default};
