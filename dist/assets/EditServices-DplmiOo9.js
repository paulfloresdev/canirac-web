import{f as te,c as ae,d as se,r as t,b as le,j as e}from"./index-BgHAPFty.js";import{I as f}from"./Input-BmZ2rss6.js";import{D as ie}from"./Drawer-DzaHo8p3.js";import{c as ne,e as oe}from"./fetch-DXQ-Dk4T.js";import{T as D}from"./TextArea-Cx7smJno.js";import"./TabFlag-Dn8CCYEz.js";import"./url-BdNy_9Mu.js";const ge=()=>{const{token:l}=te(),c=ae(),I=se(),{service:a}=I.state||{},[v]=t.useState(a.id),[d,_]=t.useState(a.title_es),[x,L]=t.useState(a.title_en),[g,T]=t.useState(a.description_es),[p,A]=t.useState(a.description_en),[h,U]=t.useState(a.contact_name),[b,z]=t.useState(a.phone),[i,w]=t.useState(null),[u,O]=t.useState(a.img_path),[o,j]=t.useState(u?1:0),[C,P]=t.useState(!1),[R,G]=t.useState(!1),[J,$]=t.useState(!1),[F,q]=t.useState(!1),[B,H]=t.useState(!1),[K,M]=t.useState(!1),[Q,S]=t.useState(!1),[W,y]=t.useState(!1),{showSnackbar:s}=le();t.useEffect(()=>{l||c("/admin/login")},[l,c]),t.useEffect(()=>{i&&(O(URL.createObjectURL(i)),console.log(u),console.log(i),o!==1&&j(2))},[i]);const X=async n=>{n.preventDefault();const r=d==="",m=x==="",N=g==="",k=p==="",V=h==="",E=b.length!==10;if(P(r),G(m),$(N),q(k),H(V),M(E),!r&&!m&&!N&&!k&&!V&&!E){if(!l){s("Error de autenticación.","error"),c("dashboard/login");return}S(!0);const Z=JSON.stringify({title_es:d,title_en:x,description_es:g,description_en:p,contact_name:h,phone:b});try{await ne("services",v,Z,l),s("Servicio actualizado correctamente.","success")}catch(ee){s(`Ocurrió un error al guardar los datos. ${ee}`,"error")}finally{S(!1)}}},Y=async n=>{if(n.preventDefault(),i){if(!l){s("Error de autenticación.","error"),c("dashboard/login");return}y(!0);const r=new FormData;r.append("img",i);try{await oe("services",v,r,l),s("Imagen actualizada exitosamente.","success"),j(1),w(null)}catch(m){s("Ocurrió un error al actualizar la imagen.","error"),console.log(m)}finally{y(!1)}}else s("No se ha seleccionado ninguna imagen.","error")};return e.jsxs("div",{className:"h-screen flex flex-col lg:flex-row",children:[e.jsx(ie,{page:2}),e.jsx("div",{className:"flex-1 flex-col space-y-4 overflow-y-auto h-full bg-background-darker dark:bg-background-deep p-16",children:e.jsxs("div",{className:"",children:[e.jsx("span",{className:"font-normal",children:"Editar servicio"}),e.jsxs("div",{className:"w-full flex flex-row space-x-4 mt-4",children:[e.jsx("form",{onSubmit:Y,className:"w-3/12 2xl:w-1/6 h-full bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-8",children:e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center space-y-4",children:[e.jsx("span",{className:"font-normal",children:"Imagen"}),u?e.jsx("img",{src:u,alt:d,className:"w-full h-auto rounded-md p-1 border-solid border-2 border-border dark:border-border-dark object-cover"}):e.jsx("div",{}),e.jsx("input",{type:"file",accept:"image/*,video/*",onChange:n=>w(n.target.files?n.target.files[0]:null),className:"block w-full max-w-xs text-sm text-gray-500 dark:text-gray-300"}),e.jsx("div",{className:"w-full flex flex-col space-y-2 justify-center ",children:e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium",children:W?o===0||o===2?"Agregando...":"Actualizando...":o===0||o===2?"Agregar":"Actualizar"})})]})}),e.jsxs("form",{onSubmit:X,className:"w-9/12 2xl:w-5/6 h-full bg-accent dark:bg-accent-dark rounded-custom p-8 flex flex-col space-y-4",children:[e.jsx("span",{className:"font-normal",children:"Datos"}),e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(f,{type:"text",label:"Titulo",flag:"es",value:d,setValue:_,maxLength:256,status:C,width:"w-full"}),e.jsx(f,{type:"text",label:"Titulo",flag:"en",value:x,setValue:L,maxLength:256,status:R,width:"w-full"})]}),e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(D,{label:"Descripción",flag:"es",value:g,setValue:T,maxLength:2048,status:J,width:"w-full"}),e.jsx(D,{label:"Descripción",flag:"en",value:p,setValue:A,maxLength:2048,status:F,width:"w-full"})]}),e.jsxs("div",{className:"w-full flex flex-row space-x-2",children:[e.jsx(f,{type:"text",label:"Contacto",value:h,setValue:U,maxLength:128,status:B,width:"w-full"}),e.jsx(f,{type:"tel",label:"Teléfono",value:b,setValue:z,maxLength:13,status:K,width:"w-full",regExp:/^[0-9.]*$/})]}),e.jsx("button",{type:"submit",className:"w-full h-9 bg-primary hover:bg-primary-dark text-selected-dark px-2 py-1 rounded-lg text-sm font-medium mx-auto",children:Q?"Guardando...":"Guardar"})]})]})]})})]})};export{ge as default};
